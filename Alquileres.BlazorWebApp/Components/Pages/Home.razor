@page "/"
@page "/home"
@using Alquileres.Models
@using System.Text.Json
@attribute [Authorize]

<RadzenStack AlignItems="AlignItems.Center" JustifyContent="JustifyContent.Center" Style="width: 100%; height: 100%;" Gap="0px">
    <RadzenCard Style="max-width: 1000px">
        <RadzenStack Orientation="Orientation.Vertical" Gap="5px">
            @foreach (var groupedItem in groupedMenuItems)
            {
                <RadzenFieldset AllowCollapse="false" ExpandTitle="@(groupedItem.Key)" CollapseTitle="@(groupedItem.Key)"
                                ExpandAriaLabel="@(groupedItem.Key)" CollapseAriaLabel="@(groupedItem.Key)">
                    <HeaderTemplate>
                        <span class="d-inline-flex align-items-center align-middle">
                            <b>@(groupedItem.Key)</b>
                        </span>
                    </HeaderTemplate>
                    <ChildContent>
                        <RadzenStack Orientation="Orientation.Horizontal" Wrap="FlexWrap.Wrap" JustifyContent="JustifyContent.Center" Gap="0px">
                            @foreach (var item in groupedItem)
                            {
                                <CardEffect CardType="CardEffect.CardTypeEnum.Overload" Title="@(item.Title)" Description="@(item.Description)" UrlPath="@(item.UrlPath)" ImagePath="@(item.ImagePath)" />
                            }
                        </RadzenStack>
                    </ChildContent>
                </RadzenFieldset>
            }
        </RadzenStack>
    </RadzenCard>
</RadzenStack>

@code {
    private IEnumerable<IGrouping<string, MenuItem>> groupedMenuItems = new List<IGrouping<string, MenuItem>>();

    protected override void OnInitialized()
    {
        string json = File.ReadAllText("Data/MenuItems.json");
        var menuItems = JsonSerializer.Deserialize<List<MenuItem>>(json)!;
        groupedMenuItems = menuItems.GroupBy(card => card.GroupName).ToList();
    }
}